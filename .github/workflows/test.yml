name:  Test
on:
  pull_request:
  push:
    branches:
      - main

jobs:
  build:
    runs-on:
      - self-hosted
      - ubuntu-latest
    steps:
      - name: Cleanup
        uses: Roblox/cleanup-action@v2

      - name: Checkout
        uses: actions/checkout@v3

      - name: Edit test file to need formatting
        run: echo "    " >> testdata/book.proto

      - name: Run this action
        uses: ./

      - name: Check goldens
        run: diff testdata/book.proto testdata/golden/book.proto